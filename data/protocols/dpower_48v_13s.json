{
  "name": "Tianjin D-power 48V 13S",
  "manufacturer": "D-power",
  "version": "1.0",
  "description": "Protocol for Tianjin D-power 48V 13S 25Ah Li-ion battery pack",
  "cell_count": 13,
  "nominal_voltage": 48.0,
  "capacity_ah": 25.0,
  "chemistry": "Li-ion",
  "messages": [
    {
      "can_id": 513,
      "can_id_hex": "0x201",
      "name": "Pack Identification",
      "description": "Manufacturing date and serial number encoded as YYDDMMSSSS decimal format",
      "period_ms": 1000,
      "fields": [
        {
          "name": "pack_identifier",
          "description": "32-bit manufacturing identifier in decimal format YYDDMMSSSS. YY=year (add 2000), DD=day, MM=month, SSSS=4-digit serial number. Example: 2018095346 means manufactured Sept 18, 2020, serial 5346",
          "byte_offset": 0,
          "length": 4,
          "data_type": "uint32_le",
          "unit": null,
          "scale": 1.0,
          "offset": 0.0,
          "min_value": 2000010100,
          "max_value": 9999123199,
          "format": "YYDDMMSSSS",
          "decode_formula": {
            "year": "(value / 100000000) + 2000",
            "day": "(value / 1000000) % 100",
            "month": "(value / 10000) % 100",
            "serial": "value % 10000"
          }
        }
      ]
    },
    {
      "can_id": 514,
      "can_id_hex": "0x202",
      "name": "Total Pack Voltage",
      "description": "Sum of all cell voltages in millivolts",
      "period_ms": 100,
      "fields": [
        {
          "name": "total_voltage_mv",
          "description": "Total pack voltage (sum of all cells)",
          "byte_offset": 0,
          "length": 2,
          "data_type": "uint16_le",
          "unit": "mV",
          "scale": 1.0,
          "offset": 0.0,
          "min_value": 38000,
          "max_value": 54600
        },
        {
          "name": "avg_cell_voltage_mv",
          "description": "Average cell voltage calculated from total",
          "byte_offset": 0,
          "length": 2,
          "data_type": "uint16_le",
          "unit": "mV",
          "scale": 0.07692307692,
          "offset": 0.0,
          "formula": "value / 13",
          "min_value": 3000,
          "max_value": 4200
        }
      ]
    },
    {
      "can_id": 515,
      "can_id_hex": "0x203",
      "name": "Remaining Capacity and Max Capacity",
      "description": "Pack current Ah and max capacity",
      "period_ms": 50,
      "fields": [
        {
          "name": "remaining_milliamp_hours",
          "description": "Remaining capacity in milliamp-hours",
          "byte_offset": 0,
          "length": 2,
          "data_type": "uint16_le",
          "unit": "mAh",
          "scale": 1.0,
          "offset": 0.0,
          "min_value": 0,
          "max_value": 255
        },
        {
          "name": "unknown_byte_1",
          "description": "Unknown byte",
          "byte_offset": 1,
          "length": 1,
          "data_type": "uint8",
          "unit": null,
          "scale": 1.0,
          "offset": 0.0,
          "min_value": null,
          "max_value": null
        },
        {
          "name": "cell_voltage_1",
          "description": "First cell voltage in this message",
          "byte_offset": 2,
          "length": 2,
          "data_type": "uint16_le",
          "unit": "mV",
          "scale": 1.0,
          "offset": 0.0,
          "min_value": 3000,
          "max_value": 4200,
          "note": "May be individual cell voltage - needs validation"
        },
        {
          "name": "cell_voltage_2",
          "description": "Second cell voltage in this message",
          "byte_offset": 4,
          "length": 2,
          "data_type": "uint16_le",
          "unit": "mV",
          "scale": 1.0,
          "offset": 0.0,
          "min_value": 3000,
          "max_value": 4200,
          "note": "May be individual cell voltage - needs validation"
        },
        {
          "name": "cell_voltage_3",
          "description": "Third cell voltage in this message",
          "byte_offset": 6,
          "length": 2,
          "data_type": "uint16_le",
          "unit": "mV",
          "scale": 1.0,
          "offset": 0.0,
          "min_value": 3000,
          "max_value": 4200,
          "note": "May be individual cell voltage - needs validation"
        }
      ]
    },
    {
      "can_id": 516,
      "can_id_hex": "0x204",
      "name": "State/Command",
      "description": "Battery state machine or charge phase indicator",
      "period_ms": 100,
      "fields": [
        {
          "name": "state",
          "description": "State value that counts down during charging",
          "byte_offset": 0,
          "length": 1,
          "data_type": "uint8",
          "unit": null,
          "scale": 1.0,
          "offset": 0.0,
          "enum_values": {
            "34": "charging_phase_1",
            "33": "charging_phase_2",
            "32": "charging_phase_3",
            "16": "charge_complete",
            "0": "idle"
          },
          "min_value": 0,
          "max_value": 255
        }
      ]
    }
  ]
}
